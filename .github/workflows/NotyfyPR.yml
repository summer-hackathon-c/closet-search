# ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä½œæˆã•ã‚ŒãŸã¨ãã« Mattermost ã«é€šçŸ¥ã‚’é€ã‚‹ GitHub Actions ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
name: Notify Mattermost on PR to develop

on: # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œæ¡ä»¶ã‚’å®šç¾©
  pull_request:
    types: [opened]         # ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã€Œæ–°ã—ãä½œæˆã•ã‚ŒãŸæ™‚ã€ã«é™å®š
    branches:
      - develop             # å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒãŒ develop ã®å ´åˆã®ã¿é€šçŸ¥ã‚’é€ã‚‹

jobs: # å®Ÿè¡Œã™ã‚‹å‡¦ç†ã®ã¾ã¨ã¾ã‚Šï¼ˆã‚¸ãƒ§ãƒ–ï¼‰ã‚’å®šç¾©
  notify: # ã‚¸ãƒ§ãƒ–åï¼ˆä»»æ„ã®åå‰ï¼‰
    runs-on: ubuntu-latest  # GitHubãŒæä¾›ã™ã‚‹æœ€æ–°ã®Ubuntuãƒ©ãƒ³ãƒŠãƒ¼ã§å®Ÿè¡Œ

    steps: # ã‚¸ãƒ§ãƒ–å†…ã§å®Ÿè¡Œã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆå‡¦ç†ï¼‰ã‚’å®šç¾©
      - name: Send message to Mattermost # ã‚¹ãƒ†ãƒƒãƒ—åï¼ˆã‚ã‹ã‚Šã‚„ã™ã„åå‰ã‚’ä»˜ã‘ã‚‹ï¼‰
        run: | # è¤‡æ•°è¡Œã®ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è¨˜è¿°ã™ã‚‹
          # âœ… JSON å½¢å¼ã§ Mattermost ã«é€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹
          # âœ… å„ç¨® GitHub ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åŸ‹ã‚è¾¼ã‚€
          curl -X POST -H "Content-Type: application/json" \
          -d '{
            "text": "âœ… ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚\n
ãƒªãƒã‚¸ãƒˆãƒª: ${{ github.repository }}\n
PRã‚¿ã‚¤ãƒˆãƒ«: ${{ github.event.pull_request.title }}\n
ä½œæˆè€…: ${{ github.event.pull_request.user.login }}\n
URL: ${{ github.event.pull_request.html_url }}"
          }' ${{ secrets.MATTERMOST_WEBHOOK }} # ğŸ”’ Webhook URL ã¯ GitHub Secrets ã«ç™»éŒ²æ¸ˆã¿
